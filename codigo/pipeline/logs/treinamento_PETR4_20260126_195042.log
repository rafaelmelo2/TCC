Importing plotly failed. Interactive plots will not work.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1769467845.485487  122928 gpu_device.cc:2020] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 4082 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1660 SUPER, pci bus id: 0000:07:00.0, compute capability: 7.5
[I 2026-01-26 19:50:46,225] A new study created in memory with name: optuna_cnn_lstm
======================================================================
TREINAMENTO DE MODELO DE DEEP LEARNING
======================================================================
[INFO] 1 GPU(s) física(s) detectada(s):
     GPU 0: /physical_device:GPU:0
          Detalhes: {'compute_capability': (7, 5), 'device_name': 'NVIDIA GeForce GTX 1660 SUPER'}
          Memória com crescimento habilitado
[INFO] Dispositivos disponíveis:
     /device:CPU:0 (CPU)
     /device:GPU:0 (GPU)
[OK] TensorFlow configurado para usar GPU!
[OK] Teste de GPU bem-sucedido!
[OK] GPU configurada e pronta para uso!

[1/6] Carregando dados de PETR4...
[OK] Dados carregados: (35158, 9)

[2/6] Criando features...
[1/6] Criando features... Shape inicial: (35158, 9)
[OK] Target: Alta=11523 (32.8%), Baixa=11336 (32.2%), Neutro=12299 (35.0%)
[OK] Features criadas! Shape final: (35138, 23) (removidas 20 linhas com NaN)
[OK] Features criadas: (35138, 23)

[3/6] Configurando walk-forward validation...
[OK] 5 folds disponíveis

[4/6] Criando modelo CNN_LSTM...
     Dimensões: n_steps=60, n_features=12
[OK] Modelo criado: 24651 parâmetros

[5/6] Treinando com walk-forward validation...

[Fold 1/5] Treino:[0:6552] Teste:[6557:7103]
     Dividindo treino: 5193 treino, 1299 validação interna
     Otimizando CNN_LSTM com 50 trials...
  0%|          | 0/50 [00:00<?, ?it/s]                                        0%|          | 0/50 [00:25<?, ?it/s]Best trial: 0. Best value: 0.501403:   0%|          | 0/50 [00:25<?, ?it/s]Best trial: 0. Best value: 0.501403:   2%|▏         | 1/50 [00:25<20:52, 25.57s/it]                                                                                   Best trial: 0. Best value: 0.501403:   2%|▏         | 1/50 [01:22<20:52, 25.57s/it]Best trial: 1. Best value: 0.52666:   2%|▏         | 1/50 [01:22<20:52, 25.57s/it] Best trial: 1. Best value: 0.52666:   4%|▍         | 2/50 [01:22<35:13, 44.03s/it]                                                                                  Best trial: 1. Best value: 0.52666:   4%|▍         | 2/50 [02:00<35:13, 44.03s/it]Best trial: 1. Best value: 0.52666:   4%|▍         | 2/50 [02:00<35:13, 44.03s/it]Best trial: 1. Best value: 0.52666:   6%|▌         | 3/50 [02:00<32:12, 41.11s/it]                                                                                  Best trial: 1. Best value: 0.52666:   6%|▌         | 3/50 [02:30<32:12, 41.11s/it]Best trial: 1. Best value: 0.52666:   6%|▌         | 3/50 [02:30<32:12, 41.11s/it]Best trial: 1. Best value: 0.52666:   8%|▊         | 4/50 [02:30<28:14, 36.84s/it]                                                                                  Best trial: 1. Best value: 0.52666:   8%|▊         | 4/50 [04:08<28:14, 36.84s/it]Best trial: 1. Best value: 0.52666:   8%|▊         | 4/50 [04:08<28:14, 36.84s/it]Best trial: 1. Best value: 0.52666:  10%|█         | 5/50 [04:08<44:07, 58.82s/it]                                                                                  Best trial: 1. Best value: 0.52666:  10%|█         | 5/50 [04:50<44:07, 58.82s/it]Best trial: 1. Best value: 0.52666:  10%|█         | 5/50 [04:50<44:07, 58.82s/it]Best trial: 1. Best value: 0.52666:  12%|█▏        | 6/50 [04:50<38:59, 53.18s/it]                                                                                  Best trial: 1. Best value: 0.52666:  12%|█▏        | 6/50 [05:12<38:59, 53.18s/it]Best trial: 1. Best value: 0.52666:  12%|█▏        | 6/50 [05:12<38:59, 53.18s/it]Best trial: 1. Best value: 0.52666:  14%|█▍        | 7/50 [05:12<30:42, 42.84s/it]                                                                                  Best trial: 1. Best value: 0.52666:  14%|█▍        | 7/50 [07:27<30:42, 42.84s/it]Best trial: 1. Best value: 0.52666:  14%|█▍        | 7/50 [07:27<30:42, 42.84s/it]Best trial: 1. Best value: 0.52666:  16%|█▌        | 8/50 [07:27<50:41, 72.41s/it]                                                                                  Best trial: 1. Best value: 0.52666:  16%|█▌        | 8/50 [08:38<50:41, 72.41s/it]Best trial: 1. Best value: 0.52666:  16%|█▌        | 8/50 [08:38<50:41, 72.41s/it]Best trial: 1. Best value: 0.52666:  18%|█▊        | 9/50 [08:38<49:03, 71.80s/it]                                                                                  Best trial: 1. Best value: 0.52666:  18%|█▊        | 9/50 [09:28<49:03, 71.80s/it]Best trial: 1. Best value: 0.52666:  18%|█▊        | 9/50 [09:28<49:03, 71.80s/it]Best trial: 1. Best value: 0.52666:  20%|██        | 10/50 [09:28<43:23, 65.10s/it]                                                                                   Best trial: 1. Best value: 0.52666:  20%|██        | 10/50 [10:52<43:23, 65.10s/it]Best trial: 1. Best value: 0.52666:  20%|██        | 10/50 [10:52<43:23, 65.10s/it]Best trial: 1. Best value: 0.52666:  22%|██▏       | 11/50 [10:52<46:02, 70.83s/it]                                                                                   Best trial: 1. Best value: 0.52666:  22%|██▏       | 11/50 [11:36<46:02, 70.83s/it]Best trial: 1. Best value: 0.52666:  22%|██▏       | 11/50 [11:36<46:02, 70.83s/it]Best trial: 1. Best value: 0.52666:  24%|██▍       | 12/50 [11:36<39:41, 62.67s/it]                                                                                   Best trial: 1. Best value: 0.52666:  24%|██▍       | 12/50 [12:48<39:41, 62.67s/it]Best trial: 1. Best value: 0.52666:  24%|██▍       | 12/50 [12:48<39:41, 62.67s/it]Best trial: 1. Best value: 0.52666:  26%|██▌       | 13/50 [12:48<40:28, 65.64s/it]                                                                                   Best trial: 1. Best value: 0.52666:  26%|██▌       | 13/50 [13:35<40:28, 65.64s/it]Best trial: 1. Best value: 0.52666:  26%|██▌       | 13/50 [13:35<40:28, 65.64s/it]Best trial: 1. Best value: 0.52666:  28%|██▊       | 14/50 [13:35<36:02, 60.08s/it]                                                                                   Best trial: 1. Best value: 0.52666:  28%|██▊       | 14/50 [14:10<36:02, 60.08s/it]Best trial: 1. Best value: 0.52666:  28%|██▊       | 14/50 [14:10<36:02, 60.08s/it]Best trial: 1. Best value: 0.52666:  30%|███       | 15/50 [14:10<30:36, 52.47s/it]                                                                                   Best trial: 1. Best value: 0.52666:  30%|███       | 15/50 [17:51<30:36, 52.47s/it]Best trial: 1. Best value: 0.52666:  30%|███       | 15/50 [17:51<30:36, 52.47s/it]Best trial: 1. Best value: 0.52666:  32%|███▏      | 16/50 [17:51<58:29, 103.21s/it]                                                                                    Best trial: 1. Best value: 0.52666:  32%|███▏      | 16/50 [19:52<58:29, 103.21s/it]Best trial: 1. Best value: 0.52666:  32%|███▏      | 16/50 [19:52<58:29, 103.21s/it]Best trial: 1. Best value: 0.52666:  34%|███▍      | 17/50 [19:52<59:44, 108.64s/it]                                                                                    Best trial: 1. Best value: 0.52666:  34%|███▍      | 17/50 [20:20<59:44, 108.64s/it]Best trial: 1. Best value: 0.52666:  34%|███▍      | 17/50 [20:20<59:44, 108.64s/it]Best trial: 1. Best value: 0.52666:  36%|███▌      | 18/50 [20:20<44:57, 84.30s/it]                                                                                    Best trial: 1. Best value: 0.52666:  36%|███▌      | 18/50 [24:29<44:57, 84.30s/it]Best trial: 1. Best value: 0.52666:  36%|███▌      | 18/50 [24:29<44:57, 84.30s/it]Best trial: 1. Best value: 0.52666:  38%|███▊      | 19/50 [24:29<1:09:05, 133.72s/it]                                                                                      Best trial: 1. Best value: 0.52666:  38%|███▊      | 19/50 [25:24<1:09:05, 133.72s/it]Best trial: 1. Best value: 0.52666:  38%|███▊      | 19/50 [25:24<1:09:05, 133.72s/it]Best trial: 1. Best value: 0.52666:  40%|████      | 20/50 [25:24<55:04, 110.16s/it]                                                                                      Best trial: 1. Best value: 0.52666:  40%|████      | 20/50 [25:42<55:04, 110.16s/it]Best trial: 1. Best value: 0.52666:  40%|████      | 20/50 [25:42<55:04, 110.16s/it]Best trial: 1. Best value: 0.52666:  42%|████▏     | 21/50 [25:42<39:53, 82.52s/it]                                                                                    Best trial: 1. Best value: 0.52666:  42%|████▏     | 21/50 [27:40<39:53, 82.52s/it]Best trial: 1. Best value: 0.52666:  42%|████▏     | 21/50 [27:40<39:53, 82.52s/it]Best trial: 1. Best value: 0.52666:  44%|████▍     | 22/50 [27:40<43:24, 93.03s/it]